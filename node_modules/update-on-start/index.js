module.exports = function (callback) {
	const log = console.log;

	const fs = require('fs');
	const path = require('path');
	const spawn = require('child_process').spawn;

	const __parentDir = path.dirname(module.parent.filename);
	const packageText = fs.readFileSync(__parentDir + '/package.json', 'utf8');
	const package = JSON.parse(packageText);
	const gitUpdate = spawn('git', ['pull', package.repository.url]);

	gitUpdate.stdout.on('data', (data) => {
		log(`git pull stdout: ${data}`);
	});

	gitUpdate.stderr.on('data', (data) => {
		log(`git pull stderr: ${data}`);
	});

	gitUpdate.on('close', (code) => {
		const npmUpdate = spawn('npm', ['up', '--save'], {
			cwd: __parentDir
		});

		npmUpdate.stdout.on('data', (data) => {
			log(`npm update stdout: ${data}`);
		});

		npmUpdate.stderr.on('data', (data) => {
			log(`npm update stderr: ${data}`);
		});

		npmUpdate.on('close', (code) => {
			callback();
		});
	});
}
